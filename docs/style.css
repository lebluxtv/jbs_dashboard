:root{
  --bg:#0f0f10;--panel:#151517;--border:#2a2a2d;--muted:#9aa0a6;
  --text:#e6e6e6;--accent:#0aa84f;--accent-2:#ffd64d;--danger:#d73a1d;
  --radius:12px;--shadow:0 6px 30px rgba(0,0,0,.35);
  --font:ui-sans-serif,system-ui,"Segoe UI",Roboto,Helvetica,Arial;
  --mono:ui-monospace,Consolas,Monaco,monospace;
  --focus:#37cc86;
}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:var(--font);line-height:1.45}

/* Header */
.app-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:12px 16px;border-bottom:1px solid var(--border);
  background:linear-gradient(180deg,#111113,#0f0f10 60%);
}
.app-title{margin:0;font-size:20px;letter-spacing:.3px}
.header-right{display:flex;align-items:center;gap:10px}
.ws-status-text{color:var(--muted);font-size:14px}
.icon-btn{
  display:inline-flex;align-items:center;justify-content:center;
  width:28px;height:28px;border-radius:8px;border:1px solid var(--border);
  background:var(--panel);color:#cfcfcf;cursor:pointer;transition:all .15s ease;
}
.icon-btn:hover{border-color:#3a3a3d;color:#fff;transform:translateY(-1px)}

/* Tabs */
.tabs{
  display:flex;gap:10px;padding:10px 14px;border-bottom:1px solid var(--border);
  background:var(--bg);position:sticky;top:0;z-index:5
}
.tab{
  display:inline-flex;align-items:center;gap:8px;padding:8px 12px;background:var(--panel);
  border:1px solid var(--border);border-radius:10px;cursor:pointer;font-weight:600;user-select:none;
  color:var(--text);
}
.tab:hover{border-color:#3a3a3d}
.tab.active{border-color:#414145;box-shadow:inset 0 -2px 0 var(--accent);color:#fff}

/* Dots & badges */
.dot{width:10px;height:10px;border-radius:50%;box-shadow:0 0 0 2px rgba(0,0,0,.4) inset}
.dot.on{background:var(--accent)}
.dot.off{background:var(--danger)}
.badge{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:22px;height:18px;padding:0 6px;font-size:12px;font-weight:700;
  color:#111;background:var(--accent-2);border-radius:10px
}

/* Panels */
.tab-panels{padding:16px}
.tab-panel{display:none}
.panel-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.panel-head h2{margin:0;font-size:18px}
.status-inline{display:flex;align-items:center;gap:10px;color:var(--muted);font-weight:600}

/* Switch (TTS Reader only) */
.switch{
  display:inline-flex;align-items:center;gap:8px;padding:4px 6px;
  border:1px solid var(--border);border-radius:10px;background:var(--panel)
}
.switch input{display:none}
.switch .slider{
  width:36px;height:20px;border-radius:12px;background:#555;position:relative;
  transition:background .15s
}
.switch .slider::before{
  content:"";position:absolute;left:2px;top:2px;width:16px;height:16px;
  border-radius:50%;background:#ffd64d;transition:transform .15s
}
.switch input:checked + .slider{background:#22c780}
.switch input:checked + .slider::before{transform:translateX(16px)}
.switch .switch-label-text{font-size:12px;color:#cfd2d6}

/* ======== Grille générique ======== */
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
.card{
  grid-column:span 4;background:var(--panel);border:1px solid var(--border);
  border-radius:var(--radius);padding:12px;box-shadow:var(--shadow)
}
.card.stretch{grid-column:span 12}
.card.half{grid-column:span 6}
.card.span-8{grid-column:span 8}
.card.span-4{grid-column:span 4}
.card h3{margin:0 0 8px 0;font-size:15px}

/* Zones GTG */
.gtg-top{margin-bottom:14px} /* espace clair entre Filtres et le reste */
.gtg-bottom{
  display:grid;grid-template-columns:repeat(12,1fr);gap:14px
}
.gtg-bottom .part-card{grid-column:span 8}
.gtg-bottom .status-card{grid-column:span 4}
.gtg-bottom .leaderboard-card{grid-column:span 6}
.gtg-bottom .meta-card{grid-column:span 6}

/* Logs, lists, kv */
.log{
  height:220px;overflow:auto;border:1px dashed #2a2a2d;padding:10px;
  border-radius:8px;font-family:var(--mono);font-size:12px;background:#121214
}
.log p{margin:0 0 6px 0;color:#cfd2d6}

.qv-list{list-style:none;margin:0;padding:0;width:100%}
.qv-list.big li{padding:8px 0}
.qv-list li{
  padding:6px 0;border-bottom:1px dashed #2a2a2d
}
.qv-list li.acked{color:#777;background:rgba(255,255,255,0.03)}
.qv-list a{
  color:inherit;text-decoration:none;display:block
}
.qv-list li:hover{background:rgba(255,255,255,0.04)}
#qv-events-list li,#events-subs-list li{cursor:pointer}
.qv-list.clickable li{cursor:pointer}

.qv-kv{width:100%;display:grid;gap:10px}
.qv-kv div{
  display:flex;align-items:center;justify-content:space-between
}
.qv-kv span{color:var(--muted)}
.qv-ol{margin:6px 0 0 18px;padding:0}
.qv-leader h3{
  margin:12px 0 8px 0;font-size:14px;color:#cfd2d6
}

/* Overview quick view grid */
.overview-grid{
  display:grid;grid-template-columns:repeat(12,1fr);gap:16px
}
.qv-card{
  grid-column:span 4;background:var(--panel);border:1px solid var(--border);
  border-radius:var(--radius);box-shadow:var(--shadow);cursor:default;
  transition:transform .08s ease,border-color .12s ease
}
.qv-card:hover{transform:translateY(-2px);border-color:#3a3a3d}
.qv-head{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 12px;border-bottom:1px solid var(--border)
}
.qv-head h2{margin:0;font-size:16px;cursor:pointer}
.qv-body{padding:12px;min-height:220px}
.qv-foot{
  padding:8px 12px;border-top:1px dashed var(--border);
  text-align:center;color:var(--muted);font-weight:600;
  text-transform:uppercase;letter-spacing:.6px
}
#qv-events-list,#qv-tts-list{max-height:300px;overflow:auto}

/* Text utils + footer */
.muted{color:var(--muted)}
.mono{font-family:var(--mono)}
.app-footer{
  padding:14px 16px;border-top:1px solid var(--border);
  text-align:right;color:#cfd2d6
}

/* Timer emphasis */
#guess-timer,#gtg-timer{
  font-family:var(--mono);font-weight:700;letter-spacing:.5px
}

/* ---------- Guess The Game – UI ---------- */
.form-row{
  display:flex;gap:12px;flex-wrap:wrap;align-items:flex-start
}
.form-group{
  display:flex;flex-direction:column;gap:6px;min-width:200px;
  flex:1 1 240px
}
.form-group.grow{flex:2 1 360px}
.form-group.sm{min-width:140px;max-width:180px;flex:0 0 180px}
.form-group label{
  font-weight:600;line-height:1.2;margin-bottom:2px;color:#d9d9d9
}
.inline{display:flex;gap:8px;align-items:center;width:100%}

select,
input[type="number"],
input[type="text"]{
  width:100%;min-height:36px;background:var(--panel);
  border:1px solid var(--border);color:var(--text);
  border-radius:10px;padding:8px 10px;outline:none;
}
select:focus,
input[type="number"]:focus,
input[type="text"]:focus{
  border-color:var(--focus);box-shadow:0 0 0 3px rgba(55,204,134,.15);
}
::placeholder{color:#b7bcc3}

/* Buttons */
.btn{
  border:1px solid var(--border);background:var(--panel);color:var(--text);
  padding:8px 12px;border-radius:10px;cursor:pointer;
  transition:border-color .15s,transform .06s ease;
}
.btn:hover{border-color:#3a3a3d}
.btn:active{transform:translateY(1px)}
.btn:disabled{
  opacity:.55;cursor:not-allowed;filter:saturate(.6)
}
.btn.ok{background:#1a4c32;border-color:#236a45}
.btn.danger{background:#4a1f1f;border-color:#7a2f2f}
.btn.danger:hover{border-color:#9b3a3a}

/* Debug ghost button */
.btn--ghost{
  background:transparent;border-color:var(--border);
  color:var(--muted);font-size:12px;padding:4px 8px;
}
.btn--ghost:hover{
  border-color:#3a3a3d;color:#fff;background:#151517;
}

.actions-row{
  display:flex;gap:10px;align-items:center;margin-top:10px;flex-wrap:wrap
}

/* Note de manche (sous les boutons) */
.round-note{
  font-size:12px;color:var(--muted);font-weight:600;min-height:1em
}
body[data-round="running"] .round-note:empty::before{content:"Manche lancée"}
body[data-round="ended"]   .round-note:empty::before{content:"Manche terminée"}

/* Chips d’exclusion */
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chip{
  display:inline-flex;gap:8px;align-items:center;background:#121214;
  border:1px solid var(--border);border-radius:999px;padding:6px 10px
}
button.chip{
  background:#121214;border:1px solid var(--border);color:#cfd2d6;cursor:pointer;
}
button.chip:hover{filter:brightness(1.05)}
.chip-excl{
  border-color:#7a2f2f !important;background:#181313 !important
}

/* espacements */
.grid.gap-top{margin-top:16px}

/* Header lock button */
.lock-btn{
  background:var(--panel);border:1px solid var(--border);color:#cfcfcf
}
.lock-btn:hover{border-color:#3a3a3d;color:#fff;transform:translateY(-1px)}

/* ======== Filtres — collapse/expand ======== */
#filters-card{position:relative}
.filters-header{
  display:flex;align-items:center;justify-content:space-between;
  gap:10px;padding:8px 10px;border:1px solid var(--border);
  border-radius:10px;background:#121214;
  cursor:pointer;user-select:none;margin-bottom:10px;
}
.filters-header:hover{border-color:#3a3a3d}
.filters-header:focus-visible{
  outline:2px solid var(--focus);outline-offset:2px;
}
.filters-header h3{margin:0;font-size:15px}
.filters-head-right{
  display:flex;align-items:center;gap:8px;margin-left:auto
}
.pool-badge{font-weight:800}
.chevron{
  display:inline-block;line-height:1;transform:rotate(0deg);
  transition:transform .15s ease, opacity .15s ease;color:#cfd2d6
}

/* État replié : on masque le contenu et on pivote le chevron */
#filters-card.collapsed #filters{display:none}
#filters-card.collapsed .chevron{transform:rotate(-90deg);opacity:.8}

/* Par défaut, on cache le badge; JS enlèvera display:none quand il veut l’afficher */
#filters-card .pool-badge{display:none}
/* Option: n’afficher automatiquement le badge qu’en mode replié */
#filters-card.collapsed .pool-badge{display:inline-flex}

/* Filtres verrouillés pendant une manche (feedback visuel) */
body.gtg-running #filters{
  opacity:.7;
}
body.gtg-running #filters input,
body.gtg-running #filters select,
body.gtg-running #filters button{
  cursor:not-allowed;
}

/* Inputs marqués aria-disabled="true" */
[aria-disabled="true"]{
  opacity:.6;cursor:not-allowed;
}

/* ===================================================== */
/*                TTS READER – LAYOUT / LOOK             */
/* ===================================================== */

/* Grille principale du panneau TTS Reader (gauche = contrôles, droite = log/queue) */
.tts-grid{
  display:grid;
  grid-template-columns:2fr 3fr;
  gap:14px;
}

/* Carte principale TTS (réutilise .card mais avec quelques ajustements optionnels) */
.tts-card-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  margin-bottom:8px;
}
.tts-card-header h3{
  margin:0;
  font-size:15px;
}

/* Ligne de statut TTS (dot + texte + infos cooldown) */
.tts-status-row{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:13px;
  color:var(--muted);
}
.tts-status-row .dot{
  width:9px;
  height:9px;
}

/* Ligne de méta-infos : compteur, cooldown, mode, etc. */
.tts-meta-row{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-top:6px;
  font-size:12px;
  color:var(--muted);
}
.tts-meta-row span strong{
  color:var(--text);
}

/* Compteur messages TTS / file d’attente */
.tts-counter-pill{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:26px;
  padding:2px 8px;
  border-radius:999px;
  font-size:12px;
  font-weight:700;
  background:rgba(10,168,79,.1);
  color:#b9f6cf;
  border:1px solid rgba(10,168,79,.5);
}

/* Liste des messages TTS (historique / file) */
#tts-queue-list,
#tts-history-list{
  list-style:none;
  margin:0;
  padding:0;
  max-height:260px;
  overflow:auto;
  font-size:12px;
}
#tts-queue-list li,
#tts-history-list li{
  padding:6px 4px;
  border-bottom:1px dashed #2a2a2d;
}
#tts-queue-list li:last-child,
#tts-history-list li:last-child{
  border-bottom:none;
}
#tts-queue-list li .user,
#tts-history-list li .user{
  font-weight:600;
  color:#e8eaed;
}
#tts-queue-list li .msg,
#tts-history-list li .msg{
  display:block;
  margin-top:2px;
  color:#cfd2d6;
}
#tts-queue-list li .meta,
#tts-history-list li .meta{
  display:flex;
  gap:6px;
  margin-top:2px;
  font-size:11px;
  color:var(--muted);
}

/* Tags de type (chat / system / forced / skipped...) */
.tts-tag{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:1px 6px;
  border-radius:999px;
  font-size:10px;
  text-transform:uppercase;
  letter-spacing:.6px;
  border:1px solid rgba(255,255,255,.18);
  color:#e8eaed;
  background:rgba(255,255,255,.03);
}
.tts-tag--chat{border-color:rgba(10,168,79,.6);color:#b9f6cf}
.tts-tag--system{border-color:rgba(154,160,166,.6);color:#d0d3d7}
.tts-tag--skipped{border-color:rgba(215,58,29,.6);color:#f7c4bc}

/* Petite barre de configuration (cooldown, slider, etc.) */
.tts-config-row{
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
  margin-top:8px;
  font-size:12px;
}
.tts-config-row label{
  font-weight:600;
  color:#d9d9d9;
}
.tts-config-row input[type="number"]{
  max-width:90px;
}

/* Zone d’aperçu / dernier TTS lu */
.tts-last-read{
  margin-top:10px;
  padding:8px 10px;
  border-radius:8px;
  background:#121214;
  border:1px solid #26262a;
  font-size:12px;
}
.tts-last-read-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.6px;
  color:var(--muted);
  margin-bottom:4px;
}
.tts-last-read-main{
  font-size:13px;
  color:#e8eaed;
}

/* Intégration avec quick view : compteur TTS dans la carte overview */
#qv-tts-counter{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:22px;
  height:18px;
  padding:0 6px;
  border-radius:10px;
  font-size:12px;
  font-weight:700;
  background:rgba(10,168,79,.15);
  color:#b9f6cf;
}

/* État “aucun TTS” dans la vue TTS */
.tts-empty{
  padding:8px 4px;
  font-size:12px;
  color:var(--muted);
  text-align:center;
}

/* ===================== Responsive ===================== */

/* ≤ 1100px : Partie passe pleine largeur; trio sur une seule ligne (3x4 colonnes) */
@media (max-width:1100px){
  .grid{grid-template-columns:repeat(12,1fr)}
  .card{grid-column:span 6}
  .qv-card{grid-column:span 6}

  .gtg-bottom{grid-template-columns:repeat(12,1fr)}
  .gtg-bottom .part-card{grid-column:span 12}
  .gtg-bottom .status-card,
  .gtg-bottom .leaderboard-card,
  .gtg-bottom .meta-card{grid-column:span 4}

  .form-group.sm{flex:1 1 48%;max-width:none}

  /* TTS Reader : passe en pile verticale */
  .tts-grid{
    grid-template-columns:1fr;
  }
}

/* ≤ 900px : champs plus compacts */
@media (max-width:900px){
  .form-group{min-width:150px;flex:1 1 200px}
  .form-group.sm{min-width:120px;max-width:160px;flex:1 1 160px}
}

/* ≤ 720px : trio status/leader/meta sur la même ligne (3 x 2 colonnes) */
@media (max-width:720px){
  .grid{grid-template-columns:repeat(6,1fr)}
  .overview-grid{grid-template-columns:repeat(6,1fr)}
  .qv-card{grid-column:span 6}
  .tabs{flex-wrap:wrap}

  .gtg-bottom{grid-template-columns:repeat(6,1fr)}
  .gtg-bottom .part-card{grid-column:span 6} /* pleine ligne */
  .gtg-bottom .status-card,
  .gtg-bottom .leaderboard-card,
  .gtg-bottom .meta-card{grid-column:span 2}

  .card.stretch{grid-column:span 6}

  .form-group{flex:1 1 100%;min-width:0}
  .form-group.sm{flex:1 1 48%;max-width:none}

  /* TTS Reader : full width sur mobile */
  .tts-grid{
    grid-template-columns:1fr;
  }
}


/* =========================
   Mods Whispers (Overview + Tab)
   ========================= */

/* 4 cards per row on wide screens (instead of 3) */
@media (min-width: 1100px){
  .overview-grid .qv-card{ grid-column: span 3; }
}
@media (max-width: 1099px){
  .overview-grid .qv-card{ grid-column: span 6; }
}
@media (max-width: 640px){
  .overview-grid .qv-card{ grid-column: span 12; }
}

/* dot color dedicated to Mods Whispers */
.dot-mods{
  background:#8a6cff;
  box-shadow:0 0 10px rgba(138,108,255,.35);
}

/* Overview card */
.qv-mods-last{ margin-bottom:10px; }
.qv-mods-last-user{ font-size:16px; font-weight:700; opacity:.95; }
.qv-mods-last-msg{
  font-size:14px;
  opacity:.9;
  white-space:pre-wrap;
  overflow-wrap:anywhere;
}

/* Tab layout : same spirit as TTS Reader (2 columns) */
.mods-grid{
  display:grid;
  grid-template-columns:2fr 3fr;
  gap:14px;
}

/* Last message block (tab) */
.mods-last-read{
  margin:10px 0 6px 0;
  padding:10px;
  border:1px dashed #2a2a2d;
  border-radius:10px;
  background:#121214;
}
.mods-last-read-title{
  font-size:12px;
  color:var(--muted);
  margin-bottom:6px;
}
.mods-last-read-user{
  font-size:15px;
  font-weight:800;
  margin-bottom:4px;
}
.mods-last-read-main{
  font-size:15px;
  font-weight:600;
  white-space:pre-wrap;
  overflow-wrap:anywhere;
}

/* List in tab: reuse TTS list styling */
#mods-whispers-list{
  list-style:none;
  margin:0;
  padding:0;
  max-height:260px;
  overflow:auto;
  border:1px dashed #2a2a2d;
  border-radius:10px;
  background:#121214;
}
#mods-whispers-list li{
  padding:8px 10px;
  border-bottom:1px dashed #2a2a2d;
  font-family:var(--mono);
  font-size:12px;
}
#mods-whispers-list li:last-child{ border-bottom:none; }
/* =============================
   Mod Whisper (distinct from real events)
   - Appears in Events lists with a scanning wave until acknowledged
   - When clicked (acked): behaves like other events (no wave, normal acked styling)
   ============================= */
.qv-list li.modwhisper{
  position:relative;
  overflow:hidden;
  font-family:var(--mono);
  letter-spacing:.2px;

  /* subtle distinct baseline (still compatible with your existing accent logic in JS) */
  border-left:4px solid #B1FF4D;
}

.qv-list li.modwhisper:not(.acked)::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: linear-gradient(90deg,
    rgba(0,0,0,0) 0%,
    rgba(177,255,77,0.00) 22%,
    rgba(177,255,77,0.26) 50%,
    rgba(77,255,214,0.18) 62%,
    rgba(0,0,0,0) 100%
  );
  transform: translateX(-120%);
  animation: modwhisperSweep 1.6s linear infinite;
  opacity:.95;
}

@keyframes modwhisperSweep{
  from { transform: translateX(-120%); }
  to   { transform: translateX(120%); }
}

